\documentclass[11pt,leqno]{article}
\usepackage[spanish,activeacute]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsfonts}
\usepackage{enumerate}
\usepackage{listings}
\usepackage{amsthm}
\usepackage[hidelinks]{hyperref}


% Título y autor
\title{Práctica final\\
		Ingeniería del conocimiento\\
		Desarrollo de un sistema experto}
		
\author{Jacinto Carrasco Castillo 	\\
		N.I.F. 32056356-Z			\\ 
		\href{jacintocc@correo.ugr.es}{jacintocc@correo.ugr.es}}
		
% Definición de estilo de definición
\newtheoremstyle{definition_wo_parentheses}
  {\topsep}% measure of space to leave above the theorem. E.g.: 3pt
  {\topsep}% measure of space to leave below the theorem. E.g.: 3pt
  {}% name of font to use in the body of the theorem
  {0pt}% measure of space to indent
  {\bfseries}% name of head font
  {.}% punctuation between head and body
  { }% space after theorem head; " " = normal interword space
  {\thmname{#1}\thmnumber{ #2.}\thmnote{ #3}}
  
  
\theoremstyle{definition_wo_parentheses}	
\newtheorem{definicion}{Definición}[subsection]

\theoremstyle{plain}	
\newtheorem{regla}{Regla}[subsection]

\theoremstyle{remark}	
\newtheorem{ejemplo}{Ejemplo}[subsection]


\begin{document}

% Título y autor
\maketitle

% Índice
\tableofcontents

\section{Resumen}

\section{Descripción del proceso de desarrollo}

\subsection{Sesión 1: 25 de abril}

\subsubsection{Información obtenida}

	Se obtienen en un primer momento cuestiones generales del sistema y del módulo de detección de valores peligrosos.	
	
\begin{enumerate}
\item El sistema estará organizado en cuatro módulos:
	\begin{enumerate}[I]
	\item Toma de decisiones
	\item Detección de valores infravalorados
	\item Detección de valores chollo
	\item Detección de valores peligrosos
\end{enumerate}
\item Un valor se considerará peligroso si está cayendo más que la media de los valores de su sector.
\item Los sectores tienen distinto grado de estabilidad.
\item Dispondremos de la tendencia del sector.
\item El sistema tiene un módulo de arranque.
\item El sistema almacenará que ha habido una noticia en una fecha determinada.
\item Las noticias tienen distinto alcance. 
\item Las noticias con un determinado alcance influyen sobre los valores de ese ámbito. Los ámbitos de menor dimensión son más determinantes que los ámbitos superiores.
\item El módulo de detección de infravalorados y sobrevalorados no se ve afectado por las noticias y la inestabilidad.
\item Sólo observaremos los valores día a día, por lo que no influirán en la toma de decisiones los repuntes diarios.
\end{enumerate}
	
\begin{definicion}[Variación]
	La variación (caída/subida) es la diferencia entre el valor frente al que se está midiendo la variación y el valor actual.
\end{definicion} 

	Pasamos a tratar ahora sobre cuestiones específicas del módulo:
	
\begin{enumerate}
\item La salida del módulo es añadir hechos.
\item Las reglas serán simples.
\item Las entradas son los valores de las inversiones en los últimos días y su relación con los movimientos en cada sector.
\end{enumerate}

\begin{definicion}[Valor peligroso]
	Diremos que un valor es peligroso si cae más que el sector por cinco días.
\end{definicion}

\begin{ejemplo}
	Supongamos que durante cinco días el sector bancario baja un $5\%$ y Bankia baja un $10\%$. Entonces consideraremos que el valor de Bankia es peligroso.
\end{ejemplo}

\begin{regla}[Valor peligroso]
	Si un valor cae durante cinco días y ha caído más de un $5\%$ con respecto a su sector, se considera un valor peligroso.
\end{regla}

\paragraph{Estabilidad} La estabilidad de un determinado valor viene dada por las noticias sobre el valor y el sector al que pertenezca. La estabilidad influye, como veremos a continuación, en la toma de decisiones según sus valores. Un valor inestable que se vea afectado por una noticia positiva se considerará estable durante dos días a partir de la llegada de la noticia. Un valor que se considere estable pasará también a ser inestable por dos días si se introduce una noticia negativa que le afecte. Se tienen las siguientes consideraciones sobre los sectores:

\begin{enumerate}[a]
\item Servicios: Es inestable si la economía va mal.
\item Construcción: Sector inestable.
\end{enumerate}

\begin{regla}[Valor inestable peligroso]
	Si un valor inestable cae durante tres días y ha caído más de un $5\%$ con respecto a su sector, se considera un valor peligroso.
\end{regla}

\subsection{Diferentes sesiones}

	Durante el resto de sesiones se han ido planteando dudas al experto a partir de la documentación con el conocimiento del SE inversor conforme éstas iban surgiendo.
	
\paragraph{Estructura en módulos} La estructura en módulos del sistema es distinta a la que se extrajo del experto en la primera sesión. No hay módulo de detección de valores chollos y la 

\begin{enumerate}
\item[0] módulo de entrada de datos y deducción de valores inestables
\item[1] módulo de detección de valores peligrosos
\item[2] módulo de detección de valores infravalorados y sobrevalorados
\item[3] módulo de realización de propuestas
	\begin{enumerate}[a]
		\item obtención de posibles propuestas
		\item realización de posibles propuestas
	\end{enumerate}
\end{enumerate}
	
\begin{regla}[Valor inestable - Servicios]
	Si la economía está bajando, los valores del sector servicios son inestables por defecto. Se considerará, según el experto, que la economía está bajando si tiene pérdidas durante cinco días. 
\end{regla}	

\begin{regla}[Detección de valores infravalorados - Repunte]
	Si la empresa ha caído bastante (más de un $30\%$) en los últimos 3,6, ó 12 meses y ha subido pero no mucho (según el experto, menos de un $10\%$) en el último mes y el PER es bajo, la empresa está infravalorada.
\end{regla}	

\begin{regla}[Detección de valores infravalorados - Valor mejor que su sector]
	Si la empresa es grande, el RPD es alto y el PER Mediano, además no está bajando (ha crecido en el global de la última semana) y se comporta mejor que su sector (su variación en la última semana es mayor que la del sector), la empresa está infravalorada.
\end{regla}	

\begin{definicion}[Rendimiento esperado]
	Entendemos el rendimiento esperado como la suma de la revalorización anual esperada más los dividendos anuales esperados. Nos permitirá ordenar las posibles operaciones para su recomendación. 
\end{definicion}

\paragraph{Rendimiento esperado} Podemos estimar la revalorización anual esperada como el mejor valor de la variación en el último año, los últimos 6 ó 3 meses. El experto ha indicado que, debido a que en el último año la bolsa ha bajado, se propondría cambiar incluso buenos valores que tengamos, por otros cuyo RPD sea mayor que la suma del RPD del valor que disponemos más la variación anterior (negativa debido a la bajada de la bolsa). El experto, al observar que la propuesta de intercambiar es aún muy extensa, propone incluir la variación del último mes en la estimación de la revalorización anual esperada. Para las reglas dadas por el experto, calcularemos de forma distinta el rendimiento esperado según sus indicaciones, que repercutirá en el orden de selección de las medidas a proponer al usuario.

\begin{regla}[Inversión en empresas infravaloradas]
	 Si una empresa está infravalorada y el usuario tiene  dinero para invertir proponer invertir el dinero en las acciones de la empresa. Posteriormente se preguntará al usuario la cantidad a invertir y no se contemplan más reglas para decidir cuánto invertir en cada valor o sector.
\end{regla}	
	
\begin{definicion}[Precio del dinero]
	Tipo de interés fijado por el Banco Central Europeo para el préstamo de dinero a las entidades financieras. 
\end{definicion}

\begin{regla}[Venta de empresas sobrevaloradas]
	Si una empresa de mi cartera está sobrevalorada y el rendimiento por año $<5 +\mathbf{precio del dinero}$ proponer vender las acciones de esa empresa. Entendemos como el rendimiento por año la suma del RPD$\% +$ la variación del precio de las acciones que esperamos obtener en el año siguiente, que se puede estimar como la variación del último año.
\end{regla}	

\begin{regla}[Cambio por valores más rentables]
	 Si una empresa no está sobrevalorada y su RPD es mayor que el rendimiento esperado de una empresa de mi cartera que no está infravalorada más el $1\%$ de comisión por la transacción, proponer cambiar las acciones de una empresa por las de la otra. Aquí se calcula el rendimiento esperado de una empresa con la descripción anterior.
\end{regla}

\section{Descripción del sistema desarrollado}

\subsection{Variables de entrada del problema}

	\paragraph{Datos del IBEX35} El fichero \texttt{Analisis.txt} contiene la información del día anterior del IBEX35. Para cada valor de la bolsa, incluye una serie de atributos que usaremos en la deducción de nuevos datos y en la realización de propuestas.
	
	\begin{itemize}
		\item \textbf{Nombre} del valor
		\item \textbf{Precio} de la acción al cierre de la sesión
		\item \textbf{Variación} del precio de la acción con respecto al día anterior.
		\item \textbf{Capitalización}: Valor total de la empresa
		\item \textbf{PER}: Capitalización por beneficios anuales
		\item \textbf{RPD}: Reparto de dividendos
		\item \textbf{Tamaño} de la empresa
		\item \textbf{Etiqueta PER}: Categorización del PER
		\item \textbf{Etiqueta RPD}: Categorización del RPD
		\item \textbf{Sector}
		\item $\mathbf{\%}$\textbf{Variación 5 días}
		\item \textbf{Pérdidas en 3 días consecutivos}
		\item \textbf{Pérdidas en 5 días consecutivos}
		\item \textbf{Variación resp. al sector} durante 5 días.
		\item \textbf{Variación resp. al sector $<-5\%$}
		\item \textbf{Var. mensual}
		\item \textbf{Var. trimestral}
		\item \textbf{Var. semestral}
		\item \textbf{Var. anual}
	\end{itemize}
	
	Se incluirá en cada valor de la bolsa el rendimiento anual esperado, siguiendo la regla descrita anteriormente.
	
	
	\paragraph{Datos de los sectores} En el fichero \texttt{AnalisisSectores.txt} se encuentra la información relativa al global del IBEX35 y la media de los valores del sector.
	
	\begin{itemize}
		\item \textbf{Nombre} del sector
		\item \textbf{Variación} media de las empresas del sector.
		\item Suma de la \textbf{capitalización} de las empresas del sector.
		\item \textbf{PER} medio de las empresas del sector
		\item \textbf{RPD} medio de las empresas del sector
		\item $\mathbf{\%}$ \textbf{IBEX}
		\item $\mathbf{\%}$\textbf{Variación 5 días} media de las empresas del sector.
		\item \textbf{Pérdidas en 3 días consecutivos}
		\item \textbf{Pérdidas en 5 días consecutivos}
		\item \textbf{Var. mensual}
		\item \textbf{Var. trimestral}
		\item \textbf{Var. semestral}
		\item \textbf{Var. anual}
	\end{itemize}
	
	Además, declaramos en el hecho \texttt{(PrecioDinero 0)}, como constante, que podremos modificar, cuando así lo disponga el BCE en el fichero \texttt{Definicion.clp}. También se puede modificar en este fichero el número máximo de propuestas a realizar, actualmente declarado como 5.\\
	El resto de la entrada del programa se corresponde con la interacción del usuario.
	
\subsection{Variables de salida del problema}
	
	Las variables de salida son, fundamentalmente, las propuestas que se realizan al usuario. Estas incluyen la explicación que daría el experto sobre por qué las ha presentado. Cada hecho deducido por el sistema sobre los valores en bolsa o la economía en general incluye al hecho la explicación, lo que facilita la composición de la explicación de la propuesta final. Interiormente se deducen otros valores, como son los valores inestables, valores peligrosos, sobrevalorados o infravalorados, cuya definición,  incluida en la descripción de las sesiones, ayuda a comprender los motivos por los cuales se realizan las propuestas.\\
	En el módulo de interacción con el usuario, cuando éste va a salir del programa, tiene la posibilidad de guardar o no el fichero con la cartera de acciones que tiene en ese momento el sistema, lo cual constituye también una salida del programa. Para evaluar el sistema experto podríamos tomar la cartera final del día anterior y ver si vamos ganando dinero o no.
	
\subsection{Conocimiento global del sistema}

	El conocimiento global del sistema está compuesto por los datos de entrada y las reglas deducidas por el experto, 
	
\subsection{Estructura de funcionamiento del esquema de razonamiento}
\subsection{Lista de hechos usados y representación}
\subsection{Hechos y reglas de cada módulo}


\section{Manual de uso}


\end{document}